<ion-header class="ion-no-border" [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="tabs/profile"></ion-back-button>
    </ion-buttons>
    <ion-title> Parrainage & Récompenses </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding">
  <ion-card>
    <ion-card-content>
      <div style="text-align: center">
        <div style="font-size: 18px; margin-bottom: 8px">
          Votre code de parrainage
        </div>
        <ion-chip color="primary" style="font-size: 18px">
          {{ user?.referral_code }}
        </ion-chip>
        <ion-button
          size="small"
          fill="outline"
          color="primary"
          style="margin-left: 8px"
          (click)="writeToClipboard()"
        >
          Copier
        </ion-button>
      </div>
      <div style="margin-top: 18px">
        <p>
          Partagez ce code à vos amis. Lorsqu'ils s'inscrivent, vous gagnez des
          points !
        </p>

        <!-- Bouton Inviter un ami -->
        <ion-button
          expand="block"
          fill="solid"
          color="success"
          (click)="inviterAmi()"
          style="margin-top: 12px"
        >
          <ion-icon name="person-add" slot="start"></ion-icon>
          Inviter un ami (+10 pts)
        </ion-button>
      </div>
    </ion-card-content>
  </ion-card>
  <ion-card>
    <ion-card-header>
      <ion-card-title>
        <ion-icon name="share-social-outline" color="primary"></ion-icon>
        Suivez-nous sur les réseaux sociaux
      </ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ion-list class="profile-actions">
        <ion-item button>
          <ion-icon
            name="logo-facebook"
            slot="start"
            color="primary"
          ></ion-icon>
          <ion-label>Facebook</ion-label>
          <ion-badge color="success" slot="end">+5 pts</ion-badge>
        </ion-item>
        <ion-item button>
          <ion-icon name="logo-tiktok" slot="start" color="primary"></ion-icon>
          <ion-label>TikTok</ion-label>
          <ion-badge color="success" slot="end">+5 pts</ion-badge>
        </ion-item>
        <ion-item button>
          <ion-icon
            name="logo-instagram"
            slot="start"
            color="primary"
          ></ion-icon>
          <ion-label>Instagram</ion-label>
          <ion-badge color="success" slot="end">+5 pts</ion-badge>
        </ion-item>
      </ion-list>
      <div
        style="font-size: 13px; color: var(--ion-color-medium); margin-top: 8px"
      >
        Suivez-nous sur chaque réseau pour gagner des points bonus !
      </div>
    </ion-card-content>
  </ion-card>
  <!-- Section des filleuls -->
  <ion-card *ngIf="filleuls.length > 0">
    <ion-card-header>
      <ion-card-title>
        <ion-icon name="people" color="primary"></ion-icon>
        Mes filleuls ({{ filleuls.length }})
      </ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ion-list class="profile-actions">
        <ion-item *ngFor="let filleul of filleuls">
          <ion-avatar slot="start">
            <ion-icon
              name="person-circle"
              color="primary"
              style="font-size: 2.5em"
            ></ion-icon>
          </ion-avatar>
          <ion-label>
            <h2 style="color: azure">{{ filleul.name }}</h2>
            <p>Inscrit le {{ filleul.created_at | date:'dd/MM/yyyy' }}</p>
          </ion-label>
          <ion-badge color="success" slot="end">
            {{ filleul.points }} pts
          </ion-badge>
        </ion-item>
      </ion-list>
      <div
        style="
          font-size: 13px;
          color: var(--ion-color-medium);
          margin-top: 12px;
          text-align: center;
        "
      >
        Vous gagnez des points à chaque inscription de vos filleuls !
      </div>
    </ion-card-content>
  </ion-card>

  <!-- Message si aucun filleul -->
  <ion-card *ngIf="filleuls.length === 0">
    <ion-card-content style="text-align: center; padding: 2rem">
      <ion-icon
        name="people-outline"
        color="medium"
        style="font-size: 4em; margin-bottom: 1rem"
      ></ion-icon>
      <h3 style="color: var(--ion-color-medium)">
        Aucun filleul pour le moment
      </h3>
      <p style="color: var(--ion-color-medium)">
        Invitez vos amis à rejoindre G4M Player et gagnez des points !
      </p>
    </ion-card-content>
  </ion-card>
</ion-content>
